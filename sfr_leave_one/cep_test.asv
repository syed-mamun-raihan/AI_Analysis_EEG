%-- 9/24/06 11:50 AM --%
function cep_test()
    vcor = 0;
    ncor = 0;
    tot = 0;

    [test,setv,setn,groups]=loadData();
    start=1;
    padding=11;
    t=1;
    tgap=1;
    size(setv)
    size(setn)
    for c=1:1:max(size(test))/2
        endrow=start+padding-1;
        class = classify(test(t,:),[setv(start:endrow,:);setn(start:endrow,:)],groups);
        if class == 1
               vcor = vcor+1;
        else
            disp(sprintf('vaso %i failed',c));
        end
        tot = tot+1;
        t=t+tgap;
        class = classify(test(t,:),[setv(start:endrow,:);setn(start:endrow,:)],groups);
        if class == 0
            ncor = ncor +1;
        else
            disp(sprintf('nonvaso %i failed',c));
        end
        tot = tot+1;
        start = endrow+1
        t=t+tgap
    end;

    tot = tot/2;
    disp('-----------------')    
    disp('Leave One Out Method with Cepstrum Distance using linear discriminant analysis')
    disp('-----------------')
    disp(sprintf('True positive segments %i out of %i',vcor, tot));
    disp(sprintf('True negetive segments %i out of %i',ncor, tot));
    TPF = (vcor / tot)*100;
    TNF = (ncor / tot)*100;
    disp(sprintf('TPF %2.2f%%',TPF));
    disp(sprintf('TNF %2.2f%%',TNF));
    disp(sprintf('Chi-Squared Goodness of fit with Yates correction %2.2f',((tot-vcor - 0.5)^2)/vcor+((tot-ncor - 0.5)^2)/ncor));

    cd ../sfr_leave_one
    save cep_test.mat
end 

function [test,train1,train2,groups]= loadData()
cd ../rv1
%trendGen(10,10,true);
load validation.mat;
vaso1 = cep(1,98:102);%1
nonvaso1=cep(1,71:75);
vaso11 = cep(2,98:102);%1
nonvaso11=cep(2,71:75);
cd ../masse2
%trendGen(10,20,true);
load validation.mat;
vaso2 = cep(6,41:45);%6
nonvaso2 = cep(6,1:5);
vaso21 = cep(3,41:45);%5
nonvaso21 = cep(3,1:5);
cd ../voth3
%trendGen(10,30,true);
load validation.mat;
vaso3 = cep(2,1:5);%5
nonvaso3 = cep(2,66:70);
vaso31 = cep(1,1:5);%5
nonvaso31 = cep(1,66:70);
cd ../liz4/
%trendGen(10,40,true);
load validation.mat;
vaso4=cep(4,51:55);%2
nonvaso4=cep(4,6:10);
vaso41=cep(2,51:55);%2
nonvaso41=cep(2,6:10);
cd ../coma8 
%unable to determine 2 channel
%trendGen(10,50,true);
load validation.mat;
vaso5=cep(4,6:10);%2
nonvaso5=cep(4,35:39);
vaso51=cep(5,6:10);%2
nonvaso51=cep(5,35:39);
cd ../coma9
%trendGen(10,60,true);
load validation.mat;
vaso6=cep(4,5:9);%3
nonvaso6=cep(4,38:42);
vaso61=cep(6,41:45);%3
nonvaso61=cep(6,4:8);
%---------------------------
test=[];
test = [vaso1;nonvaso1;vaso11;nonvaso11;vaso2;nonvaso2;vaso21;nonvaso21];
test = [test;vaso3;nonvaso3;vaso31;nonvaso31;vaso4;nonvaso4;vaso41;nonvaso41];
test = [test;vaso5;nonvaso5;vaso51;nonvaso51;vaso6;nonvaso6;vaso61;nonvaso61];
%vaso 1
set3v =[vaso11; vaso2; vaso21; vaso3; vaso31; vaso4; vaso41; vaso5; vaso51; vaso6; vaso61];
set3n =[nonvaso11; nonvaso2; nonvaso21; nonvaso3; nonvaso31; nonvaso4; nonvaso41; nonvaso5; nonvaso51; nonvaso6; nonvaso61];
%vaso 11
set4v =[vaso1; vaso2; vaso21; vaso3; vaso31; vaso4; vaso41; vaso5; vaso51; vaso6; vaso61];
set4n =[nonvaso1; nonvaso2; nonvaso21; nonvaso3; nonvaso31; nonvaso4; nonvaso41; nonvaso5; nonvaso51; nonvaso6; nonvaso61];
%vaso2
set5v =[vaso1; vaso11; vaso21; vaso3; vaso31; vaso4; vaso41; vaso5; vaso51; vaso6; vaso61];
set5n =[nonvaso1; nonvaso11; nonvaso21; nonvaso3; nonvaso31; nonvaso4; nonvaso41; nonvaso5; nonvaso51; nonvaso6; nonvaso61];
%vaso21
set6v =[vaso1; vaso11; vaso2; vaso3; vaso31; vaso4; vaso41; vaso5; vaso51; vaso6; vaso61];
set6n =[nonvaso1; nonvaso11; nonvaso2; nonvaso3; nonvaso31; nonvaso4; nonvaso41; nonvaso5; nonvaso51; nonvaso6; nonvaso61];
%vaso3
set7v =[vaso1; vaso11; vaso2; vaso21; vaso31; vaso4; vaso41; vaso5; vaso51; vaso6; vaso61];
set7n =[nonvaso1; nonvaso11; nonvaso2; nonvaso21; nonvaso31; nonvaso4; nonvaso41; nonvaso5; nonvaso51; nonvaso6; nonvaso61];
%vaso31
set8v =[vaso1; vaso11; vaso2; vaso21; vaso3; vaso4; vaso41; vaso5; vaso51; vaso6; vaso61];
set8n =[nonvaso1; nonvaso11; nonvaso2; nonvaso21; nonvaso3; nonvaso4; nonvaso41; nonvaso5; nonvaso51; nonvaso6; nonvaso61];
%vaso4
set9v =[vaso1; vaso11; vaso2; vaso21; vaso3; vaso31; vaso41; vaso5; vaso51; vaso6; vaso61];
set9n =[nonvaso1; nonvaso11; nonvaso2; nonvaso21; nonvaso3; nonvaso31; nonvaso41; nonvaso5; nonvaso51; nonvaso6; nonvaso61];
%vaso41
set10v =[vaso1; vaso11; vaso2; vaso21; vaso3; vaso31; vaso4; vaso5; vaso51; vaso6; vaso61];
set10n =[nonvaso1; nonvaso11; nonvaso2; nonvaso21; nonvaso3; nonvaso31; nonvaso4; nonvaso5; nonvaso51; nonvaso6; nonvaso61];
%vaso5
set11v =[vaso1; vaso11; vaso2; vaso21; vaso3; vaso31; vaso4; vaso41; vaso51; vaso6; vaso61];
set11n =[nonvaso1; nonvaso11; nonvaso2; nonvaso21; nonvaso3; nonvaso31; nonvaso4; nonvaso41; nonvaso51; nonvaso6; nonvaso61];
%vaso51
set12v =[vaso1; vaso11; vaso2; vaso21; vaso3; vaso31; vaso4; vaso41; vaso5; vaso6; vaso61];
set12n =[nonvaso1; nonvaso11; nonvaso2; nonvaso21; nonvaso3; nonvaso31; nonvaso4; nonvaso41; nonvaso5; nonvaso6; nonvaso61];
%vaso6
set2v =[vaso1; vaso11; vaso2; vaso21; vaso3; vaso31; vaso4; vaso41; vaso5; vaso51; vaso61];
set2n =[nonvaso1; nonvaso11; nonvaso2; nonvaso21; nonvaso3; nonvaso31; nonvaso4; nonvaso41; nonvaso5; nonvaso51; nonvaso61];
%vaso61------------------------------
set1v =[vaso1; vaso11; vaso2; vaso21; vaso3; vaso31; vaso4; vaso41; vaso5; vaso51; vaso6];
set1n =[nonvaso1; nonvaso11; nonvaso2; nonvaso21; nonvaso3; nonvaso31; nonvaso4; nonvaso41; nonvaso5; nonvaso51; nonvaso6];

train1 = [];
train2 = [];
train1 = [train1;set3v;set4v;set5v;set6v;set7v;set9v;set10v;set11v;set12v;set2v;set1v];
train2 = [train2;set3n;set4n;set5n;set6n;set7n;set9n;set10n;set11n;set12n;set2n;set1n];

groups = [1;1;1;1;1;1;1;1;1;1;1;0;0;0;0;0;0;0;0;0;0;0];
end